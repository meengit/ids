<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <title>Objekte und Funktionen</title>
  <link href="https://fonts.googleapis.com/css?family=ABeeZee|Open+Sans&amp;subset=latin-ext" rel="stylesheet"> 
  <script src="https://use.typekit.net/lll5bfl.js"></script>
  <script>try{Typekit.load({ async: true });}catch(e){}</script>
  <link href="/css/style.css" rel="stylesheet">
  <link href="/css/syntax.css" rel="stylesheet">
  
</head>
<body>
  <div id="topline"></div>
  <div id="logobar">
    <a href="#0" alt="GitHub Account A. Eberhard" target="_blank">
      <img alt="Logo GitHub" src="https://meengit.github.io/ids/img/logobar/github.png">
    </a>
    <a href="http://gfz.ch/ids" alt="Projektberschreibung auf gfz.ch" target="_blank">
      <img alt="Logo Grafisches Forum Zürich" src="https://meengit.github.io/ids/img/logobar/gfz.png">
    </a>
    <a href="http://www.medienformfarbe.ch/" alt="Kursausschreibung medien form farbe" target="_blank">
      <img alt="Logo medien form farbe" src="https://meengit.github.io/ids/img/logobar/medienformfarbe.jpg">
    </a>
  </div>
  <main>
    <nav>
      
<ul>

    <li>
        <a href="/">
            
                Release Notes
            
        </a>
    </li>
    

    <li>
        <a href="/adobe-ids/">
            
                Projekt
            
        </a>
    </li>
    

    <li>
        <a href="/skript/">
            
                Zu diesem Skript
            
        </a>
    </li>
    

    <li>
        <a href="/einfuehrung/">
            
                Einführung ins Thema
            
        </a>
    </li>
    

    <li>
        <a href="/js-grundlagen/">
            
                Grundlagen Javascript
            
        </a>
    </li>
    

    <li>
        <a href="/var-datentypen/">
            
                Variablen & Datentypen
            
        </a>
    </li>
    

    <li>
        <a href="/obj-fn/">
            
                <b>Objekte & Funktionen</b>
            
        </a>
    </li>
    

    <li>
        <a href="/schleifen/">
            
                Schleifen & Iteration
            
        </a>
    </li>
    

    <li>
        <a href="/operatoren/">
            
                Operatoren
            
        </a>
    </li>
    

    <li>
        <a href="/skripte-grundlagen/">
            
                Skripte, Grundlagen
            
        </a>
    </li>
    

    <li>
        <a href="/skripte-fuer-dokumente/">
            
                Skripte & Dokumente
            
        </a>
    </li>
    

    <li>
        <a href="/skripte-fuer-dialoge/">
            
                Skripte & Dialoge
            
        </a>
    </li>
    

    <li>
        <a href="/skripte-fuer-voreinstellungen/">
            
                Skripte & Voreinstellungen
            
        </a>
    </li>
    

</ul>
    </nav>
    <header>
      <h1>Objekte und Funktionen</h1>
    </header>
    <article>
      <p><h2 id="objekte">Objekte</h2>

<p>JavaScript ist keine objektorientierte, sondern eine objektbasierte Sprache. Ein Objekt besteht im Allgemeinen aus zwei Bestandteilen:</p>

<ul>
  <li><strong>Eigenschaften</strong> (auch Attribute oder Objektdaten genannt) sind die Details, die ein Objekt charakterisieren und durch welche sich ein Objekt von einem anderen unterscheidet (Grösse, Form, Beschriftung, Farbe usw.)</li>
  <li><strong>Methoden</strong> sind die aktiven Funktionalitäten, die vom Objekt bereitgestellt und mit denen bestimmte «Dinge» gemacht werden können.</li>
</ul>

<p>Ebenfalls können Objekte Zustände haben. Eine Methode (= Funktion) in einem Objekt wird mit <code class="highlighter-rouge">empfänger.methodenname(Argumente)</code> aufgerufen. Der «Empfänger» entspricht dem Aufruf des Objektnamens (Objektadresse). Eine Objekteigenschaft wird mit <code class="highlighter-rouge">empfänger.eigenschaft</code> aufgerufen.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>// Ein Objekt definieren

           Zuweisungsoperator                                                                                                    
                   │                                                                                                             
                   │                                                                                                             
                   ▼                                                                                                             
     var dasObjekt = { ◀──────────────────────────────────────────────── «Beginn» des Objekts                                    
      ▲      ▲        zahl1: 12, ◀──────────────────────────────────────────────────────────── Eigenschaft «zahl1» mit Wert 12   
      │      │        zahl2: 15, ◀──────────────────────────────────────────────────────────── Eigenschaft «zahl1» mit Wert 15   
      │      │        rechnen: function(uebergeben){ ◀──────────────────────────────────────── Beginn Methode «rechnen»            
      │      │                   var ergebnis = this.zahl1 + this.zahl2 + uebergeben;                                            
      │      │                   return ergebnis;                                                                                
      │      │                 } ◀──────────────────────────────────────────────────────────── Ende Methode «rechnen»              
      │      │       } ◀──────────────────────────────────────────────── «Ende» des Objekts                                      
      │      │                                                                                                                   
      │      │                                                                                                                   
      │ Bezeichner                                                                                                               
      │                                                                                                                          
      │                                                                                                                          
Schlüsselwort                                                                                                                    




 // Wert berechnen zahl1 + zahl2 + uebergeben (5)                                                                            
 // Ergebnis JavaScript Konsole: 32                                                                                          
 $.writeln(dasObjekt.rechnen(5));                                                                                            

 // Eigenschaft zahl1 verändern                                                                                              
 dasObjekt.zahl1 = 0;                                                                                                        

 // Wert NEU berechnen aus zahl1 (neu) + zahl2 + uebergeben (5)                                                              
 // // Ergebnis JavaScript Konsole: 20                                                                                       
 $.writeln(dasObjekt.rechnen(5));
</code></pre>
</div>

<p>Eine Variable kann in JavaScript auf viele «Inhalte» verweisen. Datentypen wie <code class="highlighter-rouge">Number</code>, <code class="highlighter-rouge">String</code> und <code class="highlighter-rouge">Array</code> waren bereits Thema dieser Dokumentation. In der Programmierung ist es jedoch oft notwendig, dass verschiedene Datentypen und Objektformen in einem Objekt gemischt werden können. Hierfür gibt es das Objekt <code class="highlighter-rouge">Object</code>. Es ist selbst die Basis aller Objekte und Datentypen und kann deshalb auch alle enthalten. Das gezeigte Beispiel weist der Variablen <code class="highlighter-rouge">dasObjekt</code> ein Objekt zu und macht sie damit selbst zum «Objekt vom Typ <code class="highlighter-rouge">Object</code>». Diese Zuweisung des Typs geschieht in JavaScript automatisch durch den Interpreter. Genauso wie er der Anweisung <code class="highlighter-rouge">var zahl = 1234;</code> automatisch (implizit) den Typ <code class="highlighter-rouge">Number</code> zuweisen würde.</p>

<p>In den bisherigen Beispielen wurde die Definition einer Variablen jeweils mit einem Semikolon (<code class="highlighter-rouge">;</code>) abgeschlossen. Im Fachjargon ist dies eine Anweisung. Sie repräsentiert eine bestimmte Quellcodepassage, die zusammengehörige Befehle enthält und endet immer mit einem Semikolon (;). Dieses teilt dem Interpreter mit, dass das Ende der Anweisung erreicht wurde und die zusammengehörigen Befehle jetzt ausgeführt werden können. Streng genommen kann das Semikolon in neueren Versionen von JavaScript weggelassen werden. Das ist allerdings nicht zu empfehlen da, je nach Interpreter Fehler entstehen können. Blöcke dagegen fassen mehrere Anweisungen in einer Gruppe zusammen – beispielsweise in Funktionen oder Schleifen. Diese zusammengehörigen Anweisungen werden in geschweifte Klammern { } OHNE abschliessendes Semikolon (;) eingeschlossen. Der JavaScript-Interpreter behandelt sie als Block respektive Einheit die als Ganzes abgearbeitet wird.</p>

<p>Im Innern unterscheiden sich Funktionen und Objekte darin, dass bei Funktionen die einzelnen Anweisungen mit Semikolon (<code class="highlighter-rouge">;</code>) abgeschlossen werden. Dagegen werden in Objekten die Eigenschaften und Methoden über den Doppelpunkt (<code class="highlighter-rouge">:</code>) zugewiesen (Zuweisungsoperator) und durch Kommas (<code class="highlighter-rouge">,</code>) statt Semikolon getrennt.</p>

<p>Methoden und Eigenschaften von Objekten lassen sich über die Punktnotation (Dot-Notation) ansprechen. Das erste Mal geschieht dies mit <code class="highlighter-rouge">$.writeln(dasObjekt.rechnen(5));</code>. Das <code class="highlighter-rouge">$</code>-Objekt wird von ExtendScript respektive Adobe zur Verfügung gestellt. Es enthält eine Reihe von Eigenschaften und Methoden für die Fehlerbehebung in Skripten, meist «Debugging» genannt. <code class="highlighter-rouge">writeln()</code> ist eine Methode des <code class="highlighter-rouge">$</code>-Objekts. Sie schreibt die übergebenen Argumente in den Klammern <code class="highlighter-rouge">()</code> in die JavaScript-Konsole des ExtendScript Toolkit. <code class="highlighter-rouge">dasObjekt.Rechnen(5)</code> ruft die Methode <code class="highlighter-rouge">rechnen</code> von <code class="highlighter-rouge">dasObjekt</code> auf, und übergibt die Zahl 5. Diese wird innerhalb von <code class="highlighter-rouge">rechnen</code> durch <code class="highlighter-rouge">uebergeben</code> referenziert und kann somit verwendet werden. <code class="highlighter-rouge">$.writeln(dasObjekt.rechnen(5));</code> macht also folgendes (von innen nach aussen): Methode <code class="highlighter-rouge">dasObjekt.rechnen(5)</code> aufrufen, warten bis die Methode das Ergebnis zurück gibt und dieses dann mittels <code class="highlighter-rouge">$.writeln()</code> in die JavaScript-Konsole schreiben.</p>

<p>Die Methode <code class="highlighter-rouge">dasObjekt.rechnen();</code> referenziert eine anonyme Funktion, erkennbar daran, dass nach dem Schlüsselwort <code class="highlighter-rouge">function</code> nicht ein Name sondern direkt die Klammern <code class="highlighter-rouge">()</code> stehen. <code class="highlighter-rouge">uebergeben</code> innerhalb dieser Klammern ist ein Parameter. Funktionen können mehrere Parameter haben. Sie werden durch Kommas getrennt. Parameter sind im Prinzip Namen, die Werte referenzieren, welche an die Funktion übergeben werden. Innerhalb der Funktion sind diese mit dem Parameternamen aufrufbar. In unserem Beispiel wird der Methode dasObjekt.rechnen(5) die Zahl 5 übergeben. Diese selbst wird als Argument bezeichnet. Der Parameter macht also das übergebene Argument innerhalb der Funktion unter einem Namen verfügbar. Ohne Parameter-Namen würde <code class="highlighter-rouge">5</code> zwar an die Funktion übergeben, wäre dann jedoch mangels Referenz innerhalb der Funktion nicht mehr auffindbar.</p>

<p>Innerhalb von <code class="highlighter-rouge">dasObjekt.rechnen();</code> gibt es die Eigenschaft <code class="highlighter-rouge">ergebnis</code>. Bei dieser wird das Schlüsselwort <code class="highlighter-rouge">this</code> angewendet, um auf die anderen Eigenschaften von <code class="highlighter-rouge">dasObjekt</code> zuzugreifen. In JavaScript gibt es <em>Closures</em> und <em>Scoping</em>. Vereinfacht formuliert sind beide Konzepte, die definieren, wie auf Eigenschaften und Methoden von Objekten zugegriffen werden kann. In unserem Beispiel sind <code class="highlighter-rouge">zahl1</code> und <code class="highlighter-rouge">zahl2</code> die Eigenschaften und <code class="highlighter-rouge">rechnen</code> die Methode von <code class="highlighter-rouge">dasObjekt</code>. Die Funktion von Rechnen ist damit eine Art virtuelles Unterobjekt von <code class="highlighter-rouge">dasObjekt</code>. Da jedoch <code class="highlighter-rouge">rechnen: function(){ ... }</code> durch die geschweiften Klammern <code class="highlighter-rouge"><span class="p">{</span><span class="w"> </span><span class="p">}</span></code> wiederum einen eigenen Block definiert, können die beiden Objekte nicht so ohne weiteres gegenseitig auf ihre Eigenschaften und Methoden zugreifen.</p>

<p><code class="highlighter-rouge">this</code> ist ein virtueller Zeiger auf das Objekt, in dessen Gültigkeitsbereich sich die aktuelle Stelle im Code befindet. Im gezeigten Beispiel beginnt der Gültigkeitsbereich von <code class="highlighter-rouge">dasObjekt</code> bei der öffnenden geschweiften Klammer <code class="highlighter-rouge"><span class="p">{</span></code> und endet mit der schliessenden geschweiften Klammer <code class="highlighter-rouge">}</code>. Die Methode <code class="highlighter-rouge">rechnen</code> gehört wie <code class="highlighter-rouge">zahl1</code> und <code class="highlighter-rouge">zahl2</code> zu <code class="highlighter-rouge">dasObjekt</code>. Damit wird sie über <code class="highlighter-rouge">this</code> ansprechbar.</p>

<p>Detaillierte deutsche Erklärungen zu <a href="http://www.mediaevent.de/JavaScript/globale-lokale-variablen.html"><em>Scoping</em></a> und <a href="http://www.mediaevent.de/JavaScript/globale-lokale-variablen.html"><em>Closures</em></a> bieten u. a. die Hilfeseiten von <a href="http://www.mediaevent.de">mediaevent.de</a>. Für ganz exakte, allerdings meist englische, Erklärungen sind die Hilfeseiten des <a href="https://developer.mozilla.org/de/">Mozilla Developer Networks</a> empfehlenswert.</p>

<h2 id="funktionen">Funktionen</h2>

<p>Eine spezielle Form der Funktion ist eine Methode. Methoden sind Funktionen, die einem Objekt zugeordnet sind und nur in Verbindung mit diesem vorkommen können. Sie lassen sich ausschliesslich via Punktnotation (Dot-Notation) ansprechen. Zum Beispiel <code class="highlighter-rouge">document.write();</code>. <code class="highlighter-rouge">write()</code> ist eine Methode des Objekts <code class="highlighter-rouge">document</code>.</p>

<p>JavaScript-Anweisungen, die als Funktion definiert sind, werden beim Laden eines Skripts nicht automatisch durch den Interpreter ausgeführt. Dies geschieht erst, wenn sie im Code explizit aufgerufen werden.</p>

<p>JavaScript besitzt eine Reihe vordefinierter Funktionen. Diese lassen sich direkt, gegebenenfalls mit Parametern, aufrufen.</p>

<p>Funktionen werden mit dem Schlüsselwort <code class="highlighter-rouge">function</code> eingeführt, gefolgt von einer Deklaration und einem Klammernpaar <code class="highlighter-rouge">()</code>. Für die Deklaration respektive den Funktionsnamen gelten die gleichen Regeln wie bei Variablen-Namen.</p>

<p>Dem Klammernpaar können optional Parameter übergeben werden. Mehrere Parameter werden mittels Komma (<code class="highlighter-rouge">,</code>) von einander getrennt. Innerhalb einer Funktion stehen die Parameter als lokale Variablen zur Verfügung. Die Bezeichner sind damit auch nur innerhalb des <em>Scope</em> (= Gültigkeitbereich) der Funktion sichtbar. Die eigentlichen Anweisungen der Funktion, die sogenannte Implementation oder Implementierung, werden nachfolgend in geschweifte Klammern ({}) eingeschlossen. Sie bilden einen sogenannten «Block».</p>

<div class="highlighter-rouge"><pre class="highlight"><code>             Bezeichner                                                        
                 │                                                            
Schlüsselwort    │     Parameter 1   Parameter 2                              
      │          │          │             │                                   
      │          │          │             │                                   
      ▼          ▼          ▼             ▼                                   
   function dieFunktion(uebergeben01, uebergeben02){                          
       return uebergeben01 + uebergeben02;                                    
   }     ▲                                                                    
         │                                                                    
         │                                                                    
         │                                                                    
         │                                                                    
         │                                                                    
    Rückgabewert                                                              




// uebergeben01 + uebergeben02 zusammenrechnen                              
// und direkt zurückgeben                                                   
// Ergebnis JavaScript Konsole: 5                                            
$.writeln(dieFunktion(2,3));                                                
                       ▲                                                    
                       │                                                    
                       │                                                    
           Argumente 1 &amp; 2, getrennt durch Kommas  
</code></pre>
</div>

<p>Soll die Funktion einen Rückgabewert (Ergebnis) liefern, muss dieser über die Sprunganweisung <code class="highlighter-rouge">return [Rückgabewert]</code> zurückgegeben werden. <code class="highlighter-rouge">return</code> sollte dabei immer die letzte Anweisung sein. Denn nach dem Aufruf von <code class="highlighter-rouge">return</code> verlässt der Interpreter die Funktion. Nachfolgender Code wird nicht mehr ausgeführt und damit für das Programm unerreichbar (unreachable Code, logischer Fehler).</p>

<h3 id="benannte-und-anonyme-funktionen">Benannte und anonyme Funktionen</h3>

<p>Im Gegensatz zur benannten Funktion hat eine anonyme Funktion keinen Namen (Deklaration). Der Verwendungszweck von anonymen Funktionen ist vielschichtig und hängt oft mit fortgeschrittenen Programmiertechniken zusammen. Etliche Frameworks setzen anonyme Funktionen intensiv ein. Sie können unter anderem automatisch, ohne speziellen Aufruf, ausgeführt werden (siehe auch <a href="http://www.peterkropff.de/site/JavaScript/anonyme_funktionen.htm">www.peterkropff.de</a>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>function([Parameterliste]){
  [Anweisungen]
}
</code></pre>
</div>

<h3 id="innere-funktionen">Innere Funktionen</h3>

<p>JavaScript erlaubt das Verschachteln von Funktionen. Dabei wird eine Funktion direkt in eine andere Funktion hinein notiert (ähnlich wie innere Klassen bei Java). Wird so programmiert, gelten folgende Regeln:</p>

<ul>
  <li>Die innere verschachtelte Funktion kann nur über die äussere aufgerufen werden und ist für alle anderen Zugriffe unzugänglich.</li>
  <li>Die innere Funktion kann die Variablen der äusseren Funktion verwenden.</li>
  <li>Die äussere Funktion hat keinen Zugriff auf die Variablen der inneren Funktion.</li>
  <li><strong><em>Die innere Funktion wird als lokale Variable der äusseren Funktion angesehen.</em></strong></li>
</ul>

<p>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>function aussen(){
  var a = 1;
  function innen(){
    document.write(a);
  } 
  // Funktion «innen» im Scope von «aussen» aufrufen um auf die Variable «a» zuzugreifen.
  // innen() aufrufen wenn aussen() aufgerufen wird
  innen(); 
} 

// wenn aussen() aufgerufen wird, wird "automatisch" innen() ausgeführt
aussen(); 
</code></pre>
</div>

<h3 id="callback-funktion">Callback-Funktion</h3>

<p>Eine Callback-Funktion, kurz Callback, ist eine JavaScript-Funktion, die einer Methode oder Funktion als Argument oder Option übergeben wird. Oftmals liefert sie als Rückgabewert eine Funktionsreferenz.</p>

<p>Eine Callback-Funktion muss eine bestimmte Struktur haben, damit sie funktioniert. Ein detailliertes <a href="https://developer.mozilla.org/de/docs/Mozilla/js-ctypes/Using_js-ctypes/Declaring_and_Using_Callbacks">Beispiel</a> gibts auf den Hilfeseiten des <a href="https://developer.mozilla.org/de/">Mozilla Developer Networks</a>.</p>

<p><strong>Einfach formuliert haben Callback-Funktionen drei Aufgaben: 1. Übergebene Argumente an die Funktionen in ihrem Innern weiterzuleiten, 2. Auf deren Rückmeldung (<code class="highlighter-rouge">return</code>) zu horchen und 3. die Rückmeldung (<code class="highlighter-rouge">return</code>) an den Aufrufer zurückzuleiten.</strong></p>

</p>
    </article>
  </main>
  <div id="footerline">
    <footer>
      <div>
        <div>
        <p>Projekt Adobe InDesign Scripting</p>
        <p>Entwicklung: A. Eberhard</p>
        <p>Kontakt: ids@meen.ch</p>
      </div>
      <div>
        <p>Dienstleistungen für GFZ-Mitglieder</p>
        <p>Grafisches Forum Zürich</p>
        <p>Seefeldstrasse 62</p>
        <p>8008 Zürich</p>
        <p><a href="http://gfz.ch/ids" target="_blank">www.gfz.ch/ids</a></p>
        <p>info@gfz.ch</p>
      </div>
      <div>
        <p>Kursadministration & Durchführung</p>
        <p>Medien Form Farbe</p>
        <p>Berufsschule für Gestaltung</p>
        <p>Frau Yvonne Koppitsch</p>
        <p>044 446 97 73</p>
        <p>weiterbildung@medienformfarbe.ch</p>
        <p>Ausstellungsstrasse 104</p>
        <p>8005 Zürich</p>
      </div>
      </div>

  </footer>
  </div>
</body>
</html>
